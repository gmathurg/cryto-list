<% include partials/header.ejs%>
<div id="content" class="main-container margin-top-70">
    <div class="col-md-12" id="currency-detail">
        <div class="col-md-4 col-xs-12 coin_summary_bar">
            <div class="name_rank_container">
                <div class="rank_flag">
                    <div class="rank_flag_text">
                        <span><%=display[0]['rank']%></span>
                    </div>
                    <div class="rank_flag_desc">
                        <p style="margin-left: 15px;" class="sprite small_coin_logo sprite-<%=(display[0]['name'].toLowerCase()).replace(/\s/g,"") %>"></p>
                    </div>
                    <div class="rank_flag_trig"></div>
                </div>
                <div class="coin_name_buttons_container">
                    <div style="margin: 16px 0px; display: inline-block">
                        <span class="coin_name_buttons_name"><%= display[0]['name']%></span>
                        <span style="display: inline-block" class="coin_name_buttons_symbol">&nbsp;(<%= display[0]['symbol']%>)</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-7 col-xs-12 coin_market_info_container">
            <div class="coin_market_info_price">
                <span style="color: rgb(255, 255, 255);">$<%=display[0]['price_usd']%></span>
                <% if(parseFloat(display[0]['percent_change_24h']) < 0){ %>
                <span class="red"><%=display[0]['percent_change_24h'] + '%'%><sub style="color: #ccc; font-size: x-small">(last 24 hrs)</sub></span>
                <% } %>
                <% if(parseFloat(display[0]['percent_change_24h']) >= 0) {%>
                <span class="green"><%=display[0]['percent_change_24h'] + '%'%><sub style="color: #ccc; font-size: x-small">(last 24 hrs)</sub></span>
                <% } %>
            </div>
            <table class="margin-top-20" style="border-collapse: collapse;">
                <tbody>
                <tr>
                    <th class="coin_market_info_th"><span>Market Cap</span></th>
                    <th class="coin_market_info_th"><span>24 Hour Volume</span></th>
                    <th class="coin_market_info_th"><span>Available Supply</span></th>
                </tr>
                <tr style="color: white;">
                    <td class="coin_market_info_td">$<%=(parseFloat(display[0]['market_cap_usd'])/1000000000).toFixed(4) %> B</td>
                    <td class="coin_market_info_td">$<%=(parseFloat(display[0]['24h_volume_usd'])/1000000000).toFixed(4) %> B</td>
                    <td class="coin_market_info_td">$<%=(parseFloat(display[0]['available_supply'])/1000000000).toFixed(4) %> B</td>
                </tr>
                <tr>
                    <th class="coin_market_info_th"><span>Total Supply</span></th>
                    <th class="coin_market_info_th"><span>Max Supply</span></th>
                    <th class="coin_market_info_th"><span>Change 1 hr</span></th>
                </tr>
                <tr style="color: white;">
                    <td class="coin_market_info_td">$<%=(parseFloat(display[0]['total_supply'])/1000000000).toFixed(4) %> B</td>
                    <td class="coin_market_info_td">$<%=(parseFloat(display[0]['max_supply'])/1000000000).toFixed(4) %> B</td>
                    <td class="coin_market_info_td"><%=display[0]['percent_change_1h']%> %</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <% include partials/loading.ejs%>
    <div class="col-md-12 col-xs-12 margin-top-70" id="charts" style="display: none">
        <div class="col-md-8 col-xs-5">
            <ul class="nav nav-pills chart-options">
                <li class="nav-item active">
                    <a class="nav-link" id="price-chart-option" data-toggle="tab" href="#price-chart-div">Price</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="volume-chart-option" data-toggle="tab" href="#volume-chart-div">Volume</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="market-cap-chart-option" data-toggle="tab" href="#market-cap-chart-div">Market Cap</a>
                </li>
            </ul>
        </div>

        <div class="col-md-2 col-xs-5" style="float: right">
            <select id="days-selector" class="form-control">
                <option value="one_day">1 Day</option>
                <option value="seven_day">7 Days</option>
                <option class="hidden-sm hidden-xs" value="thirty_day">30 Days</option>
                <option class="hidden-sm hidden-xs" value="ninety_day">90 Days</option>
            </select>
        </div>
        <div class="col-md-12 col-xs-12 margin-top-20 tab-content" id="charts">
            <div class="tab-pane active chart" id="price-chart-div">
                <canvas id="price-chart" style=""></canvas>
            </div>
            <div class="tab-pane" id="volume-chart-div">
                <canvas id="volume-chart" data-formatter="numberHumanizer" style=""></canvas>
            </div>
            <div class="tab-pane" id="market-cap-chart-div">
                <canvas id="market-cap-chart" data-formatter="numberHumanizer" style=""></canvas>
            </div>
        </div>

    </div>
</div>



<% include partials/footer.ejs%>

<script type="text/javascript">
    var details = JSON.parse(<%-JSON.stringify(details)%>);
    var symbol = details[0].symbol;
    var day = getURLParams('days') ? getURLParams('days') : 'seven_day';
    $('option[value='+day+']').attr('selected', 'selected');
    $(document).ready(function() {
//        windowSizeActions();
        $("#days-selector").change(function()
        {
            day = $("#days-selector option:selected").val();
            getHistory(symbol, day);
        });
    });

    if(symbol !== undefined){
        getHistory(symbol, day);
    }
</script>
